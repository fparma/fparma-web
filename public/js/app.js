!function(e){function n(){return o.is(":visible")}function t(n){return e("<span />").text(n).html()}var i="YYYY-MMM-DD, HH:mm (dddd)",o=e("nav .mobile-only");e(window).load(function(){window.FastClick.attach(window.document.body),window.Cookies.get("cookies_consent")||e("#cookies").removeClass("invis").hide().fadeIn().on("click",".button",function(){window.Cookies.set("cookies_consent",!0,{expires:180}),e("#cookies").fadeOut()})}),e(".message .close").on("click",function(){e(this).closest(".message").transition("fade")}),e('.ui.dropdown:not("#log-search")').dropdown(),e(".event-group .grp-desc").popup(),!function(){var n=e("#events-list");if(n.length){var t=window.localStorage&&window.localStorage.getItem("date-preference")||"local",o=function(n){e(".js-event-date").each(function(){var t=e(this);if("utc"===n)return t.html(t.attr("data-def"));var o=window.moment(t.attr("data-date").replace(/"/g,""));return"local"===n?t.html(o.format(i)):"from"===n?t.html(o.fromNow()):void 0})};t&&"utc"!==t&&(o(t),e("#js-date-select .item").removeClass("active"),e('#js-date-select .item[data-time="'+t+'"]').addClass("active")),e("#js-date-select").on("click",".item:not(.header, .active)",function(){var n=e(this),t=n.data("time");n.siblings().removeClass("active"),n.addClass("active"),window.localStorage&&window.localStorage.setItem("date-preference",t),o(t)})}}(),!function(){if(e("#squad-form").length){e('button[type="submit"]').click(function(){e(this).addClass("disabled loading")}),e("#squad-form").form({inline:!0,fields:{nick:{rules:[{type:"maxLength[64]",prompt:"Max 64 characters"}]},remark:{rules:[{type:"maxLength[128]",prompt:"Max 128 characters"}]}}});var n=e(".js-squad");n.hasClass("invis")&&n.hide().removeClass("invis").attr("disabled",!0),e("#squad-xml-accept").on("click",function(){n.fadeToggle({duration:200,complete:function(){var n=e(this);n.find("input").attr("disabled",n.is(":hidden"))}})})}}(),!function(){if(e("#event-description").length){var n=e("#js-date"),t=n.attr("data-date").replace(/['"]+/g,""),o=window.moment(t).format(i),a=window.moment.utc(t).format(i);n.html(o),e("#js-date-checkbox").on("change",function(e){n.html(e.target.checked?a:o)})}}(),!function(){var t=e("#media-screenshots");if(t.length){t.find(".row").addClass("invis").hide();var i=t.find(".segment.loading").removeClass("invis").hide(),o=function(n){var t=e.Deferred();n.data("caption",n.attr("data-caption")),n.attr("author",n.attr("data-author"));var i=function(){n.get(0).complete===!0&&n.addClass("loaded"),"pending"===t.state()&&t.resolve(n)};return n.load(i),window.setTimeout(i,5e3),n.on("error",function(){n.parentsUntil(".row").remove(),n.remove(),"pending"===t.state()&&t.resolve(null)}),n.attr("src",n.attr("href")),t.promise()},a=function(n){var i=[];return t.find(".row.invis").each(function(t){var a=e(this),s=a.find("img");if(!s.length)return!1;var r=0,d=e.Deferred();return i.push(d.promise()),a.removeClass("invis"),s.each(function(){o(e(this)).then(function(e){r++,r>=s.length&&d.resolve(a)})}),!(t>=n-1)&&void 0}),e.when.apply(e,i)},s=function(o,s){var r=e.Deferred();return i.fadeToggle(),a(o).then(function(){var o=[].slice.call(arguments);if(!o.length)return i.fadeToggle(),r.resolve(0);var a=t.find(".row.invis").length;if(!t.is(":visible"))return e.each(o,function(){e(this).show()}),i.hide(),r.resolve(a);var d=function(){var t=0,i=!s||n()?1:3,d=function(){if(t++>=i)return e.each(o,function(){e(this).show()}),r.resolve(a);var n=e(o.shift());return n.length?void n.transition("slide down",{duration:150+200*Math.random(),onComplete:d}):r.resolve(a)};d()};i.fadeToggle({complete:d})}),r.promise()},r=n()?2:5;s(r,!0).then(function(){t.featherlightGallery({beforeOpen:function(e){if(n()&&e.target)return e.stopPropagation(),window.open(e.target.src),!1},beforeContent:function(){this.$instance.find(".text-container").fadeOut("fast")},afterContent:function(){var e=this.$currentTarget,n=this.$instance.find(".text-container"),t=e.data("caption"),i=e.data("author");n.find(".caption").text(t?'"'+t+'"':""),n.find(".author").text(i?"Submitted by "+i:""),(t||i)&&n.fadeIn("fast")}}),t.find(".row.invis").length&&t.parent().waypoint(function(e){if(!t.is(":animated")&&t.is(":visible")&&"down"===e){var n=this;n.disable(),s(r,!1).then(function(e){e&&(window.Waypoint.refreshAll(),n.enable())})}},{offset:"bottom-in-view"})})}}(),!function(){var n=e("#media-videos");if(n.length){var t=e("#media-screenshots");n.hide().removeClass("invis");var i=!1,o=!1,a=!0,s=12,r=function(){i=!1,window.Waypoint.refreshAll(),a=!a},d=function(){c(),o=!0};e("#js-load-more-videos").on("click",function(){c()}),e(".js-media-nav").on("click",function(){var s=e(this);if(!i&&!s.hasClass("active")){i=!0,s.addClass("active").siblings().removeClass("active"),o||d();var l={duration:100,complete:r};a?t.fadeOut({duration:100,complete:function(){n.fadeIn(l)}}):n.fadeOut({duration:100,complete:function(){t.fadeIn(l)}})}});var l=function(n){return e(n).parent().html(n.text()).find(".ui.embed").embed({autoplay:!0})},c=function(){var t=n.find(".js-video").slice(0,s);t.length&&(i=!0,t.removeClass(".js-video").each(function(){var n=e(this),t=n.parentsUntil(".row").parent().removeClass("invis").hide();l(n),t.fadeIn("fast")}),n.find(".js-video").length||e("#js-load-more-videos").addClass("disabled"),i=!1)}}}(),!function(){var n=e("#log-search");if(n.length){var t=function(n){n||(n=e("#js-log").attr("data-log-id")),window.history&&window.history.replaceState(null,null,"/admin/logs/"+n)};t(),n.dropdown({fullTextSearch:!0,onChange:function(i){n.dropdown("refresh");var o=e.Deferred();n.addClass("disabled loading");var a=e("#js-log");a.fadeOut(function(){o.resolve()}),e.ajax({url:"/admin/logs/search",type:"POST",contentType:"application/json",data:JSON.stringify({id:i}),error:function(){o.then(function(){t(i),n.removeClass("disabled loading"),a.show().html('<span style="color: red">Failed to load log ('+i+")</span>")})}}).done(function(i){var s=e(i);o.then(function(){t(s.attr("data-log-id")),a.replaceWith(function(){return s.hide().fadeIn(function(){n.removeClass("disabled loading")})})})})}})}}(),!function(){var n=e("#server-info");if(n.length){var i=function(){var t=e("<h4>Failed to get server info</h4>");n.removeClass("loading").append(t.hide().fadeIn("slow"))};e.ajax("/a3-server-data").fail(i).done(function(o){if(!o.ok||!o.data)return i();var a=o.data,s={unknown:'<i class="yellow help icon"></i><span>unknown</span>',waiting:'<i class="yellow wait icon"></i><span>waiting</span>',playing:'<i class="green play icon"></i><span>playing</span>'},r=e("<div />").append('<p style="margin-bottom: 1em">Name: '+a.name+"</p>");if("unknown"!==a.state&&r.append("<p>Adress: "+a.adress+"</p>"),r.append("<p>State: "+s[a.state]+"</p>"),"playing"===a.state)if(r.append("<p>Island: "+a.island+"</p>").append("<p>Mission: "+a.mission+"</p>"),a.players.length){var d='<a style="cursor: pointer">Players: '+a.players.length+"/"+a.maxPlayers+'</a><div class="ui flowing popup transition hidden"><div class="ui small relaxed list">';a.players.forEach(function(e){d+='<span class="item">'+e.time+"h&nbsp;|&nbsp;"+t(e.name)+"</span>"}),d+="</div></div>",r.append(e(d).popup({on:"click",position:"bottom right",lastResort:"bottom center"}))}else r.append("<p>Players: "+a.players.length+"/"+a.maxPlayers+"</p>");if(r.append('<p class="mt-top1">TS3: thor.prfn.se</p>'),a.ts3.length){var l='<a style="cursor: pointer">Users: '+a.ts3.length+'</a><div class="ui flowing popup transition hidden"><div class="ui small ordered relaxed list">';a.ts3.forEach(function(e){l+='<span class="item">'+t(e)+"</span>"}),l+="</div></div>",r.append(e(l).popup({on:"click",position:"bottom right",lastResort:"bottom center"}))}n.removeClass("loading").find(".content").append(r.hide().fadeIn(800))})}}(),!function(){var n=e("#js-event-slots");if(n.length){var t=!1,i=function(n,i){if(!t){t=!0;var o=e(n).parentsUntil(".list",".js-slot-item"),a={eventId:e("#js-event-id").val(),slotId:o.attr("data-id")};e.ajax({url:"/events/"+i,type:"POST",contentType:"application/json",data:JSON.stringify(a)}).success(function(n){if(n.ok)return window.location.reload();var i=e('<div class="ui pointing red tiny label">'+n.error+"</div>");o.find(".content:not(.floated)").append(i),setTimeout(function(){i.remove(),t=!1},3e3)})}};n.on("click",".js-slot-reserve",function(){i(this,"slot-reserve")}),n.on("click",".js-slot-unreserve",function(){i(this,"slot-unreserve")}),n.on("click",".js-slot-kick",function(){i(this,"slot-kick")})}}()}(window.jQuery),!function(e){if("function"==typeof define&&define.amd)define(e);else if("object"==typeof exports)module.exports=e();else{var n=window.Cookies,t=window.Cookies=e(window.jQuery);t.noConflict=function(){return window.Cookies=n,t}}}(function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var i in t)n[i]=t[i]}return n}function n(t){function i(n,o,a){var s;if(arguments.length>1){if(a=e({path:"/"},i.defaults,a),"number"==typeof a.expires){var r=new Date;r.setMilliseconds(r.getMilliseconds()+864e5*a.expires),a.expires=r}try{s=JSON.stringify(o),/^[\{\[]/.test(s)&&(o=s)}catch(d){}return o=encodeURIComponent(String(o)),o=o.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)),n=n.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),n=n.replace(/[\(\)]/g,escape),document.cookie=[n,"=",o,a.expires&&"; expires="+a.expires.toUTCString(),a.path&&"; path="+a.path,a.domain&&"; domain="+a.domain,a.secure?"; secure":""].join("")}n||(s={});for(var l=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,f=0;f<l.length;f++){var p=l[f].split("="),u=p[0].replace(c,decodeURIComponent),v=p.slice(1).join("=");'"'===v.charAt(0)&&(v=v.slice(1,-1));try{if(v=t&&t(v,u)||v.replace(c,decodeURIComponent),this.json)try{v=JSON.parse(v)}catch(d){}if(n===u){s=v;break}n||(s[u]=v)}catch(d){}}return s}return i.get=i.set=i,i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(n,t){i(n,"",e(t,{expires:-1}))},i.withConverter=n,i}return n()});
//# sourceMappingURL=app.js.map
